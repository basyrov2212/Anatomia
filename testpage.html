<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–Ω–µ–≤–Ω–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è */
        .food-diary {
            max-width: 800px;
            margin: 0 auto;
        }

        #food-entries {
            max-height: 400px;
            overflow-y: auto;
        }

        .list-group-item {
            transition: all 0.2s;
        }

        .list-group-item:hover {
            background-color: #f8f9fa;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .food-diary .col-md-3 {
                margin-bottom: 10px;
            }
        }
    </style>
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–ª–∞–¥–∫–∏ -->
    <div class="tab-header" onclick="toggleTab(this, 'food-diary-tab')">
        <h5 class="mb-0">üìä –î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è</h5>
    </div>

    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ -->
    <div id="food-diary-tab" class="tab-content">
        <div class="food-diary">
            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∏—â–∏ -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏—ë–º –ø–∏—â–∏</h5>
                    <form id="add-food-form">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">–ü—Ä–∏—ë–º –ø–∏—â–∏</label>
                                <select class="form-select" id="meal-type" required>
                                    <option value="breakfast">–ó–∞–≤—Ç—Ä–∞–∫</option>
                                    <option value="lunch">–û–±–µ–¥</option>
                                    <option value="dinner">–£–∂–∏–Ω</option>
                                    <option value="snack">–ü–µ—Ä–µ–∫—É—Å</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">–ü—Ä–æ–¥—É–∫—Ç/–ë–ª—é–¥–æ</label>
                                <input type="text" class="form-control" id="food-name"
                                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–≤—Å—è–Ω–∞—è –∫–∞—à–∞" required>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">–ö–∞–ª–æ—Ä–∏–∏ (–∫–∫–∞–ª)</label>
                                <input type="number" class="form-control" id="food-calories" placeholder="0" required>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">–ë–µ–ª–∫–∏ (–≥)</label>
                                <input type="number" step="0.1" class="form-control" id="food-protein" placeholder="0"
                                    required>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">–ñ–∏—Ä—ã (–≥)</label>
                                <input type="number" step="0.1" class="form-control" id="food-fat" placeholder="0"
                                    required>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">–£–≥–ª–µ–≤–æ–¥—ã (–≥)</label>
                                <input type="number" step="0.1" class="form-control" id="food-carbs" placeholder="0"
                                    required>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-success w-100">–î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">üìÖ –°–µ–≥–æ–¥–Ω—è: <span id="current-date"></span></h5>
                    <div class="progress mb-3" style="height: 25px;">
                        <div id="calories-progress" class="progress-bar progress-bar-striped" role="progressbar"
                            style="width: 0%">0/2000 –∫–∫–∞–ª</div>
                    </div>
                    <div class="row text-center">
                        <div class="col-md-3">
                            <small class="text-muted">–ë–µ–ª–∫–∏</small>
                            <h6 id="protein-sum">0 –≥</h6>
                        </div>
                        <div class="col-md-3">
                            <small class="text-muted">–ñ–∏—Ä—ã</small>
                            <h6 id="fat-sum">0 –≥</h6>
                        </div>
                        <div class="col-md-3">
                            <small class="text-muted">–£–≥–ª–µ–≤–æ–¥—ã</small>
                            <h6 id="carbs-sum">0 –≥</h6>
                        </div>
                        <div class="col-md-3">
                            <small class="text-muted">–í—Å–µ–≥–æ</small>
                            <h6 id="total-calories">0 –∫–∫–∞–ª</h6>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ -->
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">–ú–æ–∏ –∑–∞–ø–∏—Å–∏</h5>
                    <div id="food-entries" class="list-group">
                        <!-- –ó–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ —á–µ—Ä–µ–∑ JS -->
                        <div class="text-center py-3 text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    // –î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è
    document.addEventListener('DOMContentLoaded', function () {
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
        const today = new Date();
        document.getElementById('current-date').textContent = today.toLocaleDateString('ru-RU');

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        loadFoodDiary();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
        document.getElementById('add-food-form').addEventListener('submit', function (e) {
            e.preventDefault();
            addFoodEntry();
        });
    });

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
    function addFoodEntry() {
        const mealType = document.getElementById('meal-type').value;
        const foodName = document.getElementById('food-name').value.trim();
        const calories = parseInt(document.getElementById('food-calories').value);
        const protein = parseFloat(document.getElementById('food-protein').value);
        const fat = parseFloat(document.getElementById('food-fat').value);
        const carbs = parseFloat(document.getElementById('food-carbs').value);

        if (!foodName || isNaN(calories)) return;

        const entry = {
            id: Date.now(),
            mealType,
            foodName,
            calories,
            protein,
            fat,
            carbs,
            date: new Date().toISOString().split('T')[0] // YYYY-MM-DD
        };

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
        const entries = JSON.parse(localStorage.getItem('foodDiary') || []);
        entries.push(entry);
        localStorage.setItem('foodDiary', JSON.stringify(entries));

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        renderFoodEntry(entry);
        updateNutritionStats();

        // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
        document.getElementById('add-food-form').reset();
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
    function renderFoodEntry(entry) {
        const mealTypes = {
            breakfast: '–ó–∞–≤—Ç—Ä–∞–∫',
            lunch: '–û–±–µ–¥',
            dinner: '–£–∂–∏–Ω',
            snack: '–ü–µ—Ä–µ–∫—É—Å'
        };

        const entryElement = document.createElement('div');
        entryElement.className = 'list-group-item';
        entryElement.innerHTML = `
    <div class="d-flex justify-content-between">
      <div>
        <strong>${mealTypes[entry.mealType]}</strong>: ${entry.foodName}
        <div class="text-muted small mt-1">
          –ö: ${entry.calories} –∫–∫–∞–ª | –ë: ${entry.protein}–≥ | –ñ: ${entry.fat}–≥ | –£: ${entry.carbs}–≥
        </div>
      </div>
      <button class="btn btn-sm btn-outline-danger" onclick="deleteFoodEntry(${entry.id})">
        ‚úï
      </button>
    </div>
  `;

        const container = document.getElementById('food-entries');
        if (container.firstChild?.classList?.contains('text-muted')) {
            container.innerHTML = '';
        }
        container.prepend(entryElement);
    }

    // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
    function deleteFoodEntry(id) {
        let entries = JSON.parse(localStorage.getItem('foodDiary') || []);
        entries = entries.filter(entry => entry.id !== id);
        localStorage.setItem('foodDiary', JSON.stringify(entries));

        loadFoodDiary(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π
    function loadFoodDiary() {
        const today = new Date().toISOString().split('T')[0];
        const entries = JSON.parse(localStorage.getItem('foodDiary') || []).filter(entry => entry.date === today);

        const container = document.getElementById('food-entries');
        container.innerHTML = entries.length ? '' : '<div class="text-center py-3 text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>';

        entries.forEach(entry => renderFoodEntry(entry));
        updateNutritionStats();
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function updateNutritionStats() {
        const today = new Date().toISOString().split('T')[0];
        const entries = JSON.parse(localStorage.getItem('foodDiary') || []).filter(entry => entry.date === today);

        const total = entries.reduce((acc, entry) => {
            acc.calories += entry.calories;
            acc.protein += entry.protein;
            acc.fat += entry.fat;
            acc.carbs += entry.carbs;
            return acc;
        }, { calories: 0, protein: 0, fat: 0, carbs: 0 });

        // –û–±–Ω–æ–≤–ª—è–µ–º UI
        document.getElementById('total-calories').textContent = `${total.calories} –∫–∫–∞–ª`;
        document.getElementById('protein-sum').textContent = `${total.protein.toFixed(1)} –≥`;
        document.getElementById('fat-sum').textContent = `${total.fat.toFixed(1)} –≥`;
        document.getElementById('carbs-sum').textContent = `${total.carbs.toFixed(1)} –≥`;

        // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –Ω–æ—Ä–º—É –≤ 2000 –∫–∫–∞–ª)
        const progress = (total.calories / 2000) * 100;
        const progressBar = document.getElementById('calories-progress');
        progressBar.style.width = `${Math.min(progress, 100)}%`;
        progressBar.textContent = `${total.calories}/2000 –∫–∫–∞–ª`;
        progressBar.className = `progress-bar progress-bar-striped ${progress > 100 ? 'bg-danger' : 'bg-success'}`;
    }
</script>

</html>